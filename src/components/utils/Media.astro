---
// Media.astro
const { src, alt, isVideo = false, scaling = 1, cropped = false } = Astro.props;
import { Image } from "astro:assets";

const base = import.meta.env.BASE_URL;
const cdnPrefix = import.meta.env.DEV
  ? base
  : "https://cdn.jsdelivr.net/gh/munusshih/munusshih.com@main/public";

const finalSrc = src.startsWith("/")
  ? `${cdnPrefix}${src}`
  : src;
const posterSrc = "posters" + src.replace(/\.(mp4|webm|ogg)$/i, ".jpg");
---

{
  isVideo ? (
    <video
      src={finalSrc}
      autoplay
      loop
      muted
      playsinline
      webkit-playsinline
      class={`h-auto w-full object-cover ${cropped ? "[clip-path:inset(3px)]" : ""}`}
      style={{ transform: `scale(${scaling})` }}
      alt={alt}
    >
      Your browser does not support the video tag.
    </video>
  ) : (
    <Image
      width={1920}  // Placeholder value, use most common width
      height={1080}  // Placeholder value for aspect ratio
      src={finalSrc}
      alt={'hey'}
      class={`h-auto w-full object-cover ${cropped ? "[clip-path:inset(3px)]" : ""}`}
    />
  )
}
